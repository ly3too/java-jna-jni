/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

task clean(type: Delete) {
    delete "$project.buildDir"
}

task assemble {
    def out = new ByteArrayOutputStream()
    doLast {
        exec {
            mkdir "$project.buildDir"
            workingDir "$project.buildDir"
            commandLine "cmake", "$project.projectDir"
            standardOutput = out
        }
        exec {
            workingDir "$project.buildDir"
            commandLine "make"
            standardOutput = out
        }
        logger.info(out.toString())
    }
}


task test {
    dependsOn assemble
    def out = new ByteArrayOutputStream()
    doLast {
        exec {
            workingDir "$project.buildDir"
            commandLine "make", "test"
            standardOutput = out
        }
        logger.info(out.toString())
    }
}